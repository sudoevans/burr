<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-20Z3J1CR22"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-20Z3J1CR22');
    </script>
    <link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" /><link rel="next" title="Next Steps" href="../up-next/" /><link rel="prev" title="Installing" href="../install/" />
        <link rel="canonical" href="https://burr.dagworks.io/getting_started/simple-example/" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.04.27 -->
        <title>Simple Example - Burr</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=437aa6ec" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-announcement-background: #ffba00;
  --color-announcement-text: #091E42;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../"><div class="brand">Burr</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  
  <span class="sidebar-brand-text">Burr</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User guide:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Getting Started</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../why-burr/">Why Burr?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/">Installing</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Simple Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../up-next/">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../concepts/">Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/actions/">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/state/">State</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/state-machine/">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/transitions/">Transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/tracking/">Tracking Burr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/state-persistence/">State Persistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/streaming-actions/">Streaming Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/hooks/">Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/additional-visibility/">Additional Visibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/planned-capabilities/">Planned Capabilities</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/simple/">Simple examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/chatbot/">Chatbots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/agents/">Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/ml_training/">ML Model Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/simulation/">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/creating_tests/">Creating Test Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/web-server/">Exposing in a Web Server</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://discord.gg/6Zy2DwP4f3">Discord Server</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/">Reference Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Reference Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/application/">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/actions/">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/state/">State</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/persister/">State Persistence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/conditions/">Conditions/Transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/tracking/">Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/visibility/">Tracing Inside Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/lifecycle/">Lifecycle API</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/integrations/">Integrations</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Integrations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/integrations/hamilton/">Hamilton</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/integrations/streamlit/">Streamlit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/telemetry/">Usage analytics + data privacy</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contributing/">Developing / Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Developing / Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/setup/">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/iterating/">Developing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/architecture/">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/contributing/">Contributing</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXTERNAL RESOURCES</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/dagworks-inc/burr">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://forms.gle/w9u2QKcPrztApRedA">Burr Cloud</a></li>
<li class="toctree-l1"><a class="reference external" href="https://blog.dagworks.io/">Blog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/dagworks">Twitter</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/dagworks-inc/burr/edit/main/docs/getting_started/simple-example.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="simple-example">
<span id="simpleexample"></span><h1>Simple Example<a class="headerlink" href="#simple-example" title="Link to this heading">¶</a></h1>
<p>Let’s build going to build a basic chatbot using Burr. While Burr has a host of features related to state management and inspection,
this basic tutorial is going to demonstrate two that are particularly relevant to LLM apps.</p>
<ol class="arabic simple">
<li><p>Specifying user inputs</p></li>
<li><p>Persisting state across multiple interactions</p></li>
</ol>
<p>This tutorial will set you up to do more complex things, including:</p>
<ol class="arabic simple">
<li><p>Building an application that makes decisions/handles conditional edges</p></li>
<li><p>Persisting state in a database</p></li>
<li><p>Tracking/monitoring your application</p></li>
<li><p>Generating test cases from prior application runs</p></li>
</ol>
<p>So hold tight! This gets you started with the basics but there’s a lot more you can do with little effort.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This should take about 10 minutes to complete, and give you a good sense of the library basics.
You’ll need an OpenAI key set as the environment variable <code class="docutils literal notranslate"><span class="pre">OPENAI_API_KEY</span></code>. If you don’t have one you can get one at <a class="reference external" href="https://platform.openai.com">OpenAI</a>.
If you don’t want to get one, check out the simple example of a <a class="reference external" href="https://github.com/DAGWorks-Inc/burr/tree/main/examples/hello-world-counter">counter application</a>.</p>
<p>If you want to skip ahead to the cool stuff (chatbots, ML training, simulations, etc…) feel free to jump into the deep end and start with the <a class="reference internal" href="../../examples/#id1"><span class="std std-ref">examples</span></a>.</p>
</div>
<p>🤔 If you prefer to learn by video, check out
<a class="reference external" href="https://www.youtube.com/watch?v=rEZ4oDN0GdU">this video walkthrough</a>
using <a class="reference external" href="https://github.com/DAGWorks-Inc/burr/blob/main/examples/simple-chatbot-intro/notebook.ipynb">this notebook</a>.</p>
<section id="build-a-simple-chatbot">
<h2>Build a Simple Chatbot<a class="headerlink" href="#build-a-simple-chatbot" title="Link to this heading">¶</a></h2>
<p>Let’s build! Our chatbot will accept user input and pass it to an AI. The AI will then respond with a message.</p>
<p>Let’s start by defining some actions, the building-block of Burr. You can think of actions as a function that
computes a result and modifies state. They declare what they read and write.</p>
<p>We define two actions:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">human_input</span></code> This accepts a prompt from the outside and adds it to the state</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ai_response</span></code> This takes the prompt + chat history and queries OpenAI.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>

<span class="nd">@action</span><span class="p">(</span><span class="n">reads</span><span class="o">=</span><span class="p">[],</span> <span class="n">writes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">,</span> <span class="s2">&quot;chat_history&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">human_input</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">State</span><span class="p">]:</span>
    <span class="n">chat_item</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
        <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chat_history</span><span class="o">=</span><span class="n">chat_item</span><span class="p">)</span>
    <span class="p">)</span>

<span class="nd">@action</span><span class="p">(</span><span class="n">reads</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chat_history&quot;</span><span class="p">],</span> <span class="n">writes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">,</span> <span class="s2">&quot;chat_history&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">ai_response</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">State</span><span class="p">]:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;chat_history&quot;</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>
    <span class="n">chat_item</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">},</span>
        <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chat_history</span><span class="o">=</span><span class="n">chat_item</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Before we proceed, let’s note the following about how we define these actions:</p>
<ol class="arabic simple">
<li><p>State is a dictionary – actions declare input fields (as strings) and write values to those fields</p></li>
<li><p>Actions use a specific <em>immutable</em> state object and call operations on it (<code class="docutils literal notranslate"><span class="pre">.append(...)</span></code>, <code class="docutils literal notranslate"><span class="pre">.update(...)</span></code>)</p></li>
<li><p>Functions can do whatever you want – they can use plain python, or delegate to <a class="reference external" href="langchain.io">langchain</a>, <a class="reference external" href="https://github.com/dagworks-inc/hamilton">hamilton</a>, etc…</p></li>
<li><p>We declare the parameter <code class="docutils literal notranslate"><span class="pre">prompt</span></code>, meaning that we will expect the user to pass <code class="docutils literal notranslate"><span class="pre">prompt</span></code> every time they run the graph.</p></li>
</ol>
<p>Next, let’s piece together our application. To do this, we’ll use an <code class="docutils literal notranslate"><span class="pre">ApplicationBuilder</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ApplicationBuilder</span><span class="p">()</span>
    <span class="o">.</span><span class="n">with_actions</span><span class="p">(</span><span class="n">human_input</span><span class="p">,</span> <span class="n">ai_response</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_transitions</span><span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;human_input&quot;</span><span class="p">,</span> <span class="s2">&quot;ai_response&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;ai_response&quot;</span><span class="p">,</span> <span class="s2">&quot;human_input&quot;</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">with_state</span><span class="p">(</span><span class="n">chat_history</span><span class="o">=</span><span class="p">[])</span>
    <span class="o">.</span><span class="n">with_entrypoint</span><span class="p">(</span><span class="s2">&quot;human_input&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We can visualize the application (note you need <code class="docutils literal notranslate"><span class="pre">burr[graphviz]</span></code> installed):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="s2">&quot;./graph&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/chatbot.png" class="align-center" src="../../_images/chatbot.png" />
<p>Let’s note the following about how we define the application</p>
<ol class="arabic simple">
<li><p>It is an infinite loop! It is meant to pause for new prompt input.</p></li>
<li><p>We’re just using the function names as the action names. You can also name them if you want <code class="docutils literal notranslate"><span class="pre">with_actions(human_input=human_input,</span> <span class="pre">ai_response=ai_response)</span></code>.</p></li>
<li><p>We start it with an empty <code class="docutils literal notranslate"><span class="pre">chat_history</span></code> state field</p></li>
<li><p>It utilizes a <a class="reference external" href="https://en.wikipedia.org/wiki/Builder_pattern#:~:text=The%20builder%20pattern%20is%20a,Gang%20of%20Four%20design%20patterns">builder pattern</a> – this is a bit old-school (comes from the java days), but is an easy/modular way to express your appliaction</p></li>
</ol>
<p>Finally, we can run the application – it gives back multiple pieces of information but all we’ll use is the state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">halt_after</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ai_response&quot;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="s2">&quot;Who was Aaron Burr?&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;answer:&quot;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;chat_history&quot;</span><span class="p">]),</span> <span class="s2">&quot;items in chat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The result looks exactly as you’d expect!</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>answer: Aaron Burr was an American politician and lawyer who served as the third
Vice President of the United States from 1801 to 1805 under President Thomas Jefferson.
He is also known for killing Alexander Hamilton in a famous duel in 1804.
Burr was involved in various political intrigues and controversies throughout his career,
and his reputation was tarnished by suspicions of treason and conspiracy.
2 items in chat
</pre></div>
</div>
<p>If you want to copy/paste, you can open up the following code block and add to a file called <code class="docutils literal notranslate"><span class="pre">run.py</span></code>:</p>
<details class="summary-code-run-py-code">
<summary><code>run.py</code></summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">openai</span>

<span class="kn">from</span> <span class="nn">burr.core</span> <span class="kn">import</span> <span class="n">action</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="n">ApplicationBuilder</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">persistence</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>

<span class="nd">@action</span><span class="p">(</span><span class="n">reads</span><span class="o">=</span><span class="p">[],</span> <span class="n">writes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">,</span> <span class="s2">&quot;chat_history&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">human_input</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">State</span><span class="p">]:</span>
    <span class="n">chat_item</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
        <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chat_history</span><span class="o">=</span><span class="n">chat_item</span><span class="p">)</span>
    <span class="p">)</span>

<span class="nd">@action</span><span class="p">(</span><span class="n">reads</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chat_history&quot;</span><span class="p">],</span> <span class="n">writes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">,</span> <span class="s2">&quot;chat_history&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">ai_response</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">State</span><span class="p">]:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;chat_history&quot;</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>
    <span class="n">chat_item</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">},</span>
        <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chat_history</span><span class="o">=</span><span class="n">chat_item</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ApplicationBuilder</span><span class="p">()</span>
    <span class="o">.</span><span class="n">with_actions</span><span class="p">(</span><span class="n">human_input</span><span class="p">,</span> <span class="n">ai_response</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_transitions</span><span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;human_input&quot;</span><span class="p">,</span> <span class="s2">&quot;ai_response&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;ai_response&quot;</span><span class="p">,</span> <span class="s2">&quot;human_input&quot;</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">with_state</span><span class="p">(</span><span class="n">chat_history</span><span class="o">=</span><span class="p">[])</span>
    <span class="o">.</span><span class="n">with_entrypoint</span><span class="p">(</span><span class="s2">&quot;human_input&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="s2">&quot;./graph&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">halt_after</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ai_response&quot;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="s2">&quot;Who was Aaron Burr?&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;answer:&quot;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;chat_history&quot;</span><span class="p">]),</span> <span class="s2">&quot;items in chat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</details><p>Finally, let’s open up the UI and see what it looks like (note, that if you have not installed <code class="docutils literal notranslate"><span class="pre">burr[learn]</span></code> now is a good time…).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>burr
</pre></div>
</div>
<p>You’ll see the UI pop up with projects. Navigate to <a class="reference external" href="http://localhost:7241/project/my_first_app">the UI</a> and explore!</p>
<p>Now that we’ve built a basic application, we can do the following with only a few lines of code:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="../../concepts/transitions/#id1"><span class="std std-ref">Add conditional edges</span></a> –  add a condition as a third item in the tuple to the <code class="docutils literal notranslate"><span class="pre">with_transitions</span></code> method.</p></li>
<li><p><a class="reference internal" href="../../concepts/state-persistence/#id1"><span class="std std-ref">Persist state to a database + reload</span></a> – add a <code class="docutils literal notranslate"><span class="pre">initialize_from</span></code> line to the builder and select a pre-existing/implement a custom persistence method.</p></li>
<li><p><a class="reference internal" href="../../concepts/tracking/#tracking"><span class="std std-ref">Add monitoring to track application data</span></a> – leverage <code class="docutils literal notranslate"><span class="pre">with_tracker</span></code> to track to the Burr UI and visualize your application live.</p></li>
<li><p><a class="reference external" href="https://github.com/DAGWorks-Inc/burr/tree/main/examples/test-case-creation">Generate test cases from prior runs</a> – use the <code class="docutils literal notranslate"><span class="pre">burr-testburr-test-case</span> <span class="pre">create</span></code> command to automatically generate test cases for your LLM app.</p></li>
</ol>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../up-next/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Next Steps</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../install/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installing</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Elijah ben Izzy, Stefan Krawczyk
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Simple Example</a><ul>
<li><a class="reference internal" href="#build-a-simple-chatbot">Build a Simple Chatbot</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>